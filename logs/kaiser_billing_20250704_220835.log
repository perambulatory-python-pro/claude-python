2025-07-04 22:08:36,410 - etl.kaiser_billing_processor - INFO - Starting KAISER billing period processing: 2025-05-30_to_2025-06-12
2025-07-04 22:08:36,410 - etl.kaiser_billing_processor - INFO - 
Processing region: N California
2025-07-04 22:08:36,515 - etl.kaiser_billing_processor - INFO - Loaded 8 KAISER sub-regions from database
2025-07-04 22:08:36,515 - etl.kaiser_billing_processor - INFO - Found region 'N California' with ID: 274
2025-07-04 22:08:37,431 - etl.tracktik_client - INFO - Successfully authenticated with TrackTik API
2025-07-04 22:08:37,937 - etl.tracktik_client - INFO - Fetching /rest/v1/clients: 1005 total records
2025-07-04 22:08:42,276 - etl.tracktik_client - INFO - Retrieved 1005 records from /rest/v1/clients
2025-07-04 22:08:42,276 - etl.kaiser_billing_processor - INFO - Found 188 clients in region N California
2025-07-04 22:08:42,276 - etl.kaiser_billing_processor - INFO - Loading dimensions for N California
2025-07-04 22:08:42,328 - etl.kaiser_billing_processor - ERROR - Failed to process region N California: relation "tracktik.dim_regions" does not exist
LINE 2:                     SELECT * FROM tracktik.dim_regions
                                          ^

2025-07-04 22:08:42,328 - etl.kaiser_billing_processor - INFO - 
Processing region: S California
2025-07-04 22:08:42,328 - etl.kaiser_billing_processor - INFO - Found region 'S California' with ID: 275
2025-07-04 22:08:42,686 - etl.tracktik_client - INFO - Fetching /rest/v1/clients: 1005 total records
2025-07-04 22:08:46,677 - etl.tracktik_client - INFO - Retrieved 1005 records from /rest/v1/clients
2025-07-04 22:08:46,677 - etl.kaiser_billing_processor - INFO - Found 265 clients in region S California
2025-07-04 22:08:46,678 - etl.kaiser_billing_processor - INFO - Loading dimensions for S California
2025-07-04 22:08:46,728 - etl.kaiser_billing_processor - ERROR - Failed to process region S California: relation "tracktik.dim_regions" does not exist
LINE 2:                     SELECT * FROM tracktik.dim_regions
                                          ^

2025-07-04 22:08:46,729 - etl.kaiser_billing_processor - INFO - 
Processing region: Hawaii
2025-07-04 22:08:46,729 - etl.kaiser_billing_processor - INFO - Found region 'Hawaii' with ID: 276
2025-07-04 22:08:47,191 - etl.tracktik_client - INFO - Fetching /rest/v1/clients: 1005 total records
2025-07-04 22:08:51,459 - etl.tracktik_client - INFO - Retrieved 1005 records from /rest/v1/clients
2025-07-04 22:08:51,459 - etl.kaiser_billing_processor - INFO - Found 60 clients in region Hawaii
2025-07-04 22:08:51,459 - etl.kaiser_billing_processor - INFO - Loading dimensions for Hawaii
2025-07-04 22:08:51,511 - etl.kaiser_billing_processor - ERROR - Failed to process region Hawaii: relation "tracktik.dim_regions" does not exist
LINE 2:                     SELECT * FROM tracktik.dim_regions
                                          ^

2025-07-04 22:08:51,511 - etl.kaiser_billing_processor - INFO - 
Processing region: Washington
2025-07-04 22:08:51,511 - etl.kaiser_billing_processor - INFO - Found region 'Washington' with ID: 277
2025-07-04 22:08:52,111 - etl.tracktik_client - INFO - Fetching /rest/v1/clients: 1005 total records
2025-07-04 22:08:56,612 - etl.tracktik_client - INFO - Retrieved 1005 records from /rest/v1/clients
2025-07-04 22:08:56,612 - etl.kaiser_billing_processor - INFO - Found 68 clients in region Washington
2025-07-04 22:08:56,613 - etl.kaiser_billing_processor - INFO - Loading dimensions for Washington
2025-07-04 22:08:56,673 - etl.kaiser_billing_processor - ERROR - Failed to process region Washington: relation "tracktik.dim_regions" does not exist
LINE 2:                     SELECT * FROM tracktik.dim_regions
                                          ^

2025-07-04 22:08:56,673 - etl.kaiser_billing_processor - INFO - 
Processing region: Colorado
2025-07-04 22:08:56,673 - etl.kaiser_billing_processor - INFO - Found region 'Colorado' with ID: 278
2025-07-04 22:08:57,023 - etl.tracktik_client - INFO - Fetching /rest/v1/clients: 1005 total records
2025-07-04 22:09:01,529 - etl.tracktik_client - INFO - Retrieved 1005 records from /rest/v1/clients
2025-07-04 22:09:01,530 - etl.kaiser_billing_processor - INFO - Found 84 clients in region Colorado
2025-07-04 22:09:01,530 - etl.kaiser_billing_processor - INFO - Loading dimensions for Colorado
2025-07-04 22:09:01,579 - etl.kaiser_billing_processor - ERROR - Failed to process region Colorado: relation "tracktik.dim_regions" does not exist
LINE 2:                     SELECT * FROM tracktik.dim_regions
                                          ^

2025-07-04 22:09:01,579 - etl.kaiser_billing_processor - INFO - 
Processing region: Georgia
2025-07-04 22:09:01,579 - etl.kaiser_billing_processor - INFO - Found region 'Georgia' with ID: 279
2025-07-04 22:09:02,040 - etl.tracktik_client - INFO - Fetching /rest/v1/clients: 1005 total records
2025-07-04 22:09:06,340 - etl.tracktik_client - INFO - Retrieved 1005 records from /rest/v1/clients
2025-07-04 22:09:06,340 - etl.kaiser_billing_processor - INFO - Found 50 clients in region Georgia
2025-07-04 22:09:06,340 - etl.kaiser_billing_processor - INFO - Loading dimensions for Georgia
2025-07-04 22:09:06,391 - etl.kaiser_billing_processor - ERROR - Failed to process region Georgia: relation "tracktik.dim_regions" does not exist
LINE 2:                     SELECT * FROM tracktik.dim_regions
                                          ^

2025-07-04 22:09:06,391 - etl.kaiser_billing_processor - INFO - 
Processing region: MidAtlantic
2025-07-04 22:09:06,392 - etl.kaiser_billing_processor - INFO - Found region 'MidAtlantic' with ID: 282
2025-07-04 22:09:06,852 - etl.tracktik_client - INFO - Fetching /rest/v1/clients: 1005 total records
2025-07-04 22:09:11,254 - etl.tracktik_client - INFO - Retrieved 1005 records from /rest/v1/clients
2025-07-04 22:09:11,255 - etl.kaiser_billing_processor - INFO - Found 150 clients in region MidAtlantic
2025-07-04 22:09:11,256 - etl.kaiser_billing_processor - INFO - Loading dimensions for MidAtlantic
2025-07-04 22:09:11,306 - etl.kaiser_billing_processor - ERROR - Failed to process region MidAtlantic: relation "tracktik.dim_regions" does not exist
LINE 2:                     SELECT * FROM tracktik.dim_regions
                                          ^

2025-07-04 22:09:11,307 - etl.kaiser_billing_processor - INFO - 
Processing region: Northwest
2025-07-04 22:09:11,307 - etl.kaiser_billing_processor - INFO - Found region 'Northwest' with ID: 1029
2025-07-04 22:09:11,768 - etl.tracktik_client - INFO - Fetching /rest/v1/clients: 1005 total records
2025-07-04 22:09:16,373 - etl.tracktik_client - INFO - Retrieved 1005 records from /rest/v1/clients
2025-07-04 22:09:16,374 - etl.kaiser_billing_processor - INFO - Found 6 clients in region Northwest
2025-07-04 22:09:16,374 - etl.kaiser_billing_processor - INFO - Loading dimensions for Northwest
2025-07-04 22:09:16,424 - etl.kaiser_billing_processor - ERROR - Failed to process region Northwest: relation "tracktik.dim_regions" does not exist
LINE 2:                     SELECT * FROM tracktik.dim_regions
                                          ^

2025-07-04 22:09:16,476 - root - ERROR - Fatal error in processing
Traceback (most recent call last):
  File "c:\Users\brend\Finance Ops Dropbox\Brendon Jewell\coding\claude-python\tracktik_etl\run_kaiser_billing_period.py", line 50, in main
    stats = processor.process_billing_period(START_DATE, END_DATE)
  File "c:\Users\brend\Finance Ops Dropbox\Brendon Jewell\coding\claude-python\tracktik_etl\etl\kaiser_billing_processor.py", line 126, in process_billing_period
    self._log_etl_run(overall_stats)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "c:\Users\brend\Finance Ops Dropbox\Brendon Jewell\coding\claude-python\tracktik_etl\etl\kaiser_billing_processor.py", line 454, in _log_etl_run
    ETLRunLog.log_run(stats)
    ~~~~~~~~~~~~~~~~~^^^^^^^
  File "c:\Users\brend\Finance Ops Dropbox\Brendon Jewell\coding\claude-python\tracktik_etl\etl\models.py", line 223, in log_run
    db.execute_query(query, log_data)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "c:\Users\brend\Finance Ops Dropbox\Brendon Jewell\coding\claude-python\tracktik_etl\etl\database.py", line 56, in execute_query
    cursor.execute(query, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\brend\Finance Ops Dropbox\Brendon Jewell\coding\claude-python\.venv\Lib\site-packages\psycopg2\extras.py", line 236, in execute
    return super().execute(query, vars)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.UndefinedColumn: column "sync_type" of relation "etl_sync_status" does not exist
LINE 3:             (sync_type, last_sync_time, status, records_proc...
                     ^

