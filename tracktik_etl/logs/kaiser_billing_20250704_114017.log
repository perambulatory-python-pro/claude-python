2025-07-04 11:40:18,861 - etl.kaiser_billing_processor - INFO - Starting KAISER billing period processing: 2025-05-30_to_2025-06-12
2025-07-04 11:40:18,861 - etl.kaiser_billing_processor - INFO - 
Processing region: N California
2025-07-04 11:40:19,671 - etl.tracktik_client - INFO - Successfully authenticated with TrackTik API
2025-07-04 11:40:20,220 - etl.tracktik_client - INFO - Fetching /rest/v1/clients: 1005 total records
2025-07-04 11:40:25,178 - etl.tracktik_client - INFO - Retrieved 1005 records from /rest/v1/clients
2025-07-04 11:40:25,178 - etl.kaiser_billing_processor - ERROR - Failed to process region N California: 'int' object has no attribute 'get'
2025-07-04 11:40:25,179 - etl.kaiser_billing_processor - INFO - 
Processing region: S California
2025-07-04 11:40:25,605 - etl.tracktik_client - INFO - Fetching /rest/v1/clients: 1005 total records
2025-07-04 11:40:30,357 - etl.tracktik_client - INFO - Retrieved 1005 records from /rest/v1/clients
2025-07-04 11:40:30,358 - etl.kaiser_billing_processor - ERROR - Failed to process region S California: 'int' object has no attribute 'get'
2025-07-04 11:40:30,358 - etl.kaiser_billing_processor - INFO - 
Processing region: Hawaii
2025-07-04 11:40:30,780 - etl.tracktik_client - INFO - Fetching /rest/v1/clients: 1005 total records
2025-07-04 11:40:35,440 - etl.tracktik_client - INFO - Retrieved 1005 records from /rest/v1/clients
2025-07-04 11:40:35,440 - etl.kaiser_billing_processor - ERROR - Failed to process region Hawaii: 'int' object has no attribute 'get'
2025-07-04 11:40:35,441 - etl.kaiser_billing_processor - INFO - 
Processing region: Washington
2025-07-04 11:40:35,973 - etl.tracktik_client - INFO - Fetching /rest/v1/clients: 1005 total records
2025-07-04 11:40:40,916 - etl.tracktik_client - INFO - Retrieved 1005 records from /rest/v1/clients
2025-07-04 11:40:40,917 - etl.kaiser_billing_processor - ERROR - Failed to process region Washington: 'int' object has no attribute 'get'
2025-07-04 11:40:40,917 - etl.kaiser_billing_processor - INFO - 
Processing region: Colorado
2025-07-04 11:40:41,439 - etl.tracktik_client - INFO - Fetching /rest/v1/clients: 1005 total records
2025-07-04 11:40:45,895 - etl.tracktik_client - INFO - Retrieved 1005 records from /rest/v1/clients
2025-07-04 11:40:45,896 - etl.kaiser_billing_processor - ERROR - Failed to process region Colorado: 'int' object has no attribute 'get'
2025-07-04 11:40:45,897 - etl.kaiser_billing_processor - INFO - 
Processing region: Georgia
2025-07-04 11:40:46,393 - etl.tracktik_client - INFO - Fetching /rest/v1/clients: 1005 total records
2025-07-04 11:40:50,882 - etl.tracktik_client - INFO - Retrieved 1005 records from /rest/v1/clients
2025-07-04 11:40:50,882 - etl.kaiser_billing_processor - ERROR - Failed to process region Georgia: 'int' object has no attribute 'get'
2025-07-04 11:40:50,883 - etl.kaiser_billing_processor - INFO - 
Processing region: MidAtlantic
2025-07-04 11:40:51,379 - etl.tracktik_client - INFO - Fetching /rest/v1/clients: 1005 total records
2025-07-04 11:40:55,856 - etl.tracktik_client - INFO - Retrieved 1005 records from /rest/v1/clients
2025-07-04 11:40:55,857 - etl.kaiser_billing_processor - ERROR - Failed to process region MidAtlantic: 'int' object has no attribute 'get'
2025-07-04 11:40:55,858 - etl.kaiser_billing_processor - INFO - 
Processing region: Northwest
2025-07-04 11:40:56,319 - etl.tracktik_client - INFO - Fetching /rest/v1/clients: 1005 total records
2025-07-04 11:41:00,700 - etl.tracktik_client - INFO - Retrieved 1005 records from /rest/v1/clients
2025-07-04 11:41:00,701 - etl.kaiser_billing_processor - ERROR - Failed to process region Northwest: 'int' object has no attribute 'get'
2025-07-04 11:41:00,763 - root - ERROR - Fatal error in processing
Traceback (most recent call last):
  File "c:\Users\brend\Finance Ops Dropbox\Brendon Jewell\coding\claude-python\tracktik_etl\run_kaiser_billing_period.py", line 47, in main
    stats = processor.process_billing_period(START_DATE, END_DATE)
  File "c:\Users\brend\Finance Ops Dropbox\Brendon Jewell\coding\claude-python\tracktik_etl\etl\kaiser_billing_processor.py", line 83, in process_billing_period
    self._log_etl_run(overall_stats)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "c:\Users\brend\Finance Ops Dropbox\Brendon Jewell\coding\claude-python\tracktik_etl\etl\kaiser_billing_processor.py", line 256, in _log_etl_run
    ETLRunLog.log_run(stats)
    ~~~~~~~~~~~~~~~~~^^^^^^^
  File "c:\Users\brend\Finance Ops Dropbox\Brendon Jewell\coding\claude-python\tracktik_etl\etl\models.py", line 225, in log_run
    db.execute_query(query, log_data)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "c:\Users\brend\Finance Ops Dropbox\Brendon Jewell\coding\claude-python\tracktik_etl\etl\database.py", line 56, in execute_query
    cursor.execute(query, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\brend\Finance Ops Dropbox\Brendon Jewell\coding\claude-python\.venv\Lib\site-packages\psycopg2\extras.py", line 236, in execute
    return super().execute(query, vars)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.UndefinedTable: relation "tracktik.etl_run_log" does not exist
LINE 2:             INSERT INTO tracktik.etl_run_log 
                                ^

